\section{Introduction}
Static analysis of binaries is inherently challenging because the compilation
process discards most high-level program information, such as variable and
function names, type definitions, and source-level control structures. Binary
lifters translate binaries into an intermediate representation (IR) to address
this limitation, and they have consequently attracted significant attention.

Among various forms of IR, many lifteres target LLVM Intermediate
Representation(LLVM IR), a low-level intermediate code within the LLVM compiler
infrastructure due to its extensive optimization and transformation
capabilities. 

In particular, the SoK study evaluated four LLVM IR based binary lifters. In
that study, each binary was lifted by all four tools and evaluated in terms of
analysis suitability and functional correctness. The results varied
significantly depending on the IR style: high-level IR (HIR), as generated by
RetDec and McToll, exhibited strong analysis suitability but lower functional
correctness, whereas emulation-style IR (EIR), as generated by McSema and
BinRec, achieved higher functional correctness, but was less suitable for
analysis.

As shown in Fig. 2, EIR tends to emulate machine code more closely through the
use of a virtual stack, whereas HIR more closely resembles compiler-generated
code. Because the virtual stack mimics program behavior, EIR preserves
functional correctness effectively; however, the absence of explicit variables
and other high-level information reduces its suitability for analysis.

In this study, we propose a method for transforming EIR into HIR. Although EIR
preserves program semantics well due to its emulated stack, this same structure
obscures the high-level information required for analysis. Our goal is to
eliminate the virtual stack in EIR and transform the code into HIR while
preserving semantics, thereby combining the functional correctness of EIR with
the analysis suitability of HIR.

For this purpose, we selected BinRec, a dynamic lifter, to generate EIR for
transformation. We identify three primary challenges:

1. Variable recovery â€“ BinRec does not provide explicit variables except those
derived from the virtual stack. 2. Recovery of types - All variables that
originate in the virtual stack are assigned the i32 type, which requires
inference and restoration of the correct types. 3. Recovery of functions -
BinRec employs trampoline functions for variadic functions, which hinder
function-level analysis and must be transformed into high-level style
functions.
